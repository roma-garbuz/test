(this.webpackJsonplogin=this.webpackJsonplogin||[]).push([[0],{148:function(e,t,a){e.exports=a(277)},153:function(e,t,a){},277:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(51),l=a.n(c),o=(a(153),a(7)),i=a(113),s=a(112),u=a(34),m=a.n(u),p=a(54),d=a(27),f=a(114),E=localStorage.getItem("token"),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E;try{return JSON.parse(atob(e.split(".")[1]))}catch(t){return null}},h=f.create({baseURL:"http://109.86.230.142:50000",headers:{"Content-Type":"application/json"},Authorization:"Bearer "+b()}),v=function(e){return h.post("users/authenticate",Object(d.a)({},e))},g=function(){return h.get("orders")},N=a(30),O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E;try{return JSON.parse(atob(e.split(".")[1])).exp}catch(t){return null}}(),j={firstName:null,id:null,lastName:null,role:null,token:O,username:null,isAuth:O-Math.floor(Date.now()/1e3)>0,expTime:O||null},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER_DATA":return Object(d.a)({},e,{},t.payload,{isAuth:!0,expTime:b(t.payload.token).exp});case"LOGOUT":return Object(d.a)({},e,{isAuth:!1});default:return e}},y={orders:null},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ORDERS":return Object(d.a)({},e,{},t.payload);default:return e}},x=Object(o.c)({auth:w,form:s.a,orders:k}),S=Object(o.e)(x,Object(o.a)(i.a));window.store=S;var A=S,T=a(23),_=a(21),C=a(8),D=a(56),R=a(42),F=a.n(R),I=function(e){var t=Object(n.useState)(""),a=Object(D.a)(t,2),c=a[0],l=a[1];return r.a.createElement("div",{className:"timer ".concat(c)},r.a.createElement(F.a,{initialTime:e.timer,direction:"backward",formatValue:function(e){return"".concat(e<10?"0".concat(e):e)},checkpoints:[{time:5e3,callback:function(){return l("new-timer")}},{time:0,callback:function(){return e.logout()}}]},(function(){return r.a.createElement(r.a.Fragment,null,"  ",r.a.createElement("span",{className:"time-title"},"\u0414\u043e \u043a\u043e\u043d\u0446\u0430 \u0441\u0435\u0441\u0441\u0438\u0438"),r.a.createElement("span",{className:"dotter"},"-"),r.a.createElement("span",{className:"time-item"},r.a.createElement(F.a.Hours,{formatValue:function(e){return"".concat(e)}})),r.a.createElement("span",{className:"dotter"},":"),r.a.createElement("span",{className:"time-item"},r.a.createElement(F.a.Minutes,null)),r.a.createElement("span",{className:"dotter"},":"),r.a.createElement("span",{className:"time-item"},r.a.createElement(F.a.Seconds,{formatValue:function(e){return"".concat(e)}})))})))},U=Object(C.b)((function(e){return{expTime:e.auth.expTime}}),(function(e){return{logout:function(){e({type:"LOGOUT"})}}}))((function(e){var t=Math.floor(Date.now()/1e3),a=1e3*(e.expTime-t);return console.log("newExp > "+e.expTime),r.a.createElement(I,Object.assign({},e,{timer:a}))})),q=function(e){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement("div",{className:"container justify-content-between"},r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNavDropdown"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(_.b,{to:"/",activeClassName:"active",className:" nav-link"},"\u041f\u0440\u043e\u0444\u0438\u043b\u044c")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(_.b,{to:"/shops",activeClassName:"active",className:"nav-item nav-link"},"\u041c\u0430\u0433\u0430\u0437\u0438\u043d")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(_.b,{to:"/orders",activeClassName:"active",className:"nav-item nav-link"},"\u041d\u0430\u043a\u043b\u0430\u0434\u043d\u044b\u0435")))),r.a.createElement(U,null)))},G=function(e){return r.a.createElement("div",{className:"home-page site-wrap"},r.a.createElement(q,null),r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"\u041f\u0440\u0438\u0432\u0435\u0442, ",localStorage.getItem("firstName"),"!"),r.a.createElement("h3",null,"\u0412\u0430\u0448\u0430 \u0440\u043e\u043b\u044c: ",e.role)))},J=a(118),B=a(119),L=a(120),M=a(121),V=function(e){return{isAuth:e.auth.isAuth}},W=function(e){var t=function(t){Object(M.a)(n,t);var a=Object(L.a)(n);function n(){return Object(J.a)(this,n),a.apply(this,arguments)}return Object(B.a)(n,[{key:"render",value:function(){return this.props.isAuth?r.a.createElement(e,this.props):r.a.createElement(T.a,{to:"/login"})}}]),n}(r.a.Component);return Object(C.b)(V)(t)},z=Object(o.d)(W,Object(C.b)((function(e){return{isAuth:e.auth.isAuth,role:e.auth.role}}),null))((function(e){return r.a.createElement(G,e)})),H=function(e){if(!e)return"Field is required"},$=a(110),K=a(111),P=function(e){var t=e.text,a=e.alertType,c=void 0===a?"warning":a,l=Object(n.useState)(!0),o=Object(D.a)(l,2),i=o[0],s=o[1];return i?r.a.createElement("div",{className:"alert alert-".concat(c," alert-dismissible fade show")},t,r.a.createElement("button",{type:"button",className:"close","aria-label":"Close",onClick:function(){s(!1)}},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))):null},Q=a(122),X=function(e){var t=e.input,a=e.meta,n=Object(Q.a)(e,["input","meta"]),c=a.error&&a.touched;return r.a.createElement("div",null,r.a.createElement("input",Object.assign({},t,n,{className:c?"form-control border-error":"form-control"})),c&&r.a.createElement("span",{className:"required"},a.error))},Y=Object(K.a)({form:"loginForm"})((function(e){var t=e.handleSubmit,a=e.error,n=e.submitting;return r.a.createElement("form",{className:"justify-content-center",onSubmit:t},a&&r.a.createElement(P,{text:a,alertType:"danger"}),r.a.createElement("div",{className:"form-group"},r.a.createElement($.a,{name:"username",component:X,validate:[H],placeholder:"\u041b\u043e\u0433\u0438\u043d"})),r.a.createElement("div",{className:"form-group"},r.a.createElement($.a,{name:"password",component:X,type:"password",validate:[H],placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"})),r.a.createElement("button",{className:"btn btn-primary",type:"submit",disabled:n},n&&r.a.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})," \u0412\u043e\u0439\u0442\u0438"))})),Z=Object(C.b)((function(e){return{isAuth:e.auth.isAuth}}),{login:function(e,t){return function(){var a=Object(p.a)(m.a.mark((function a(n){var r;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v(e,t);case 3:r=a.sent,n({type:"SET_USER_DATA",payload:r.data}),localStorage.clear(),localStorage.setItem("token",r.data.token),localStorage.setItem("firstName",r.data.firstName),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),a.t0.response?n(Object(N.a)("loginForm",{_error:a.t0.response.data})):a.t0.request?n(Object(N.a)("loginForm",{_error:a.t0.request})):n(Object(N.a)("loginForm",{_error:a.t0.message}));case 13:case"end":return a.stop()}}),a,null,[[0,10]])})));return function(e){return a.apply(this,arguments)}}()}})((function(e){if(e.isAuth)return r.a.createElement(T.a,{to:"/"});return r.a.createElement("section",{className:"min-vh-100 login-page"},r.a.createElement("div",{className:"login-page-caption"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row text-white"},r.a.createElement("div",{className:"col-xl-5 col-lg-6 col-md-8 col-sm-10 mx-auto text-center form p-4"},r.a.createElement("h1",{className:"display-6 py-2"},"\u0412\u0445\u043e\u0434"),r.a.createElement("div",{className:"px-2"},r.a.createElement(Y,{onSubmit:function(t){e.login(t)}})))))))})),ee=function(e){return r.a.createElement("div",{className:"home-page site-wrap"},r.a.createElement(q,null),r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"\u041d\u0430\u043a\u043b\u0430\u0434\u043d\u044b\u0435"),console.log(e.allOrders())))},te=Object(o.d)(W,Object(C.b)((function(e){return{isAuth:e.auth.isAuth}}),{allOrders:function(){return function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"GET_ORDERS",payload:g()});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}))((function(e){return r.a.createElement(ee,e)})),ae=function(e){return r.a.createElement(T.d,null,r.a.createElement(T.b,{path:"/",exact:!0,render:function(){return r.a.createElement(z,null)}}),r.a.createElement(T.b,{path:"/login",render:function(){return r.a.createElement(Z,null)}}),r.a.createElement(T.b,{path:"/orders",render:function(){return r.a.createElement(te,null)}}))},ne=function(e){return r.a.createElement(_.a,null,r.a.createElement(C.a,{store:A},r.a.createElement(ae,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[148,1,2]]]);
//# sourceMappingURL=main.88ce902f.chunk.js.map